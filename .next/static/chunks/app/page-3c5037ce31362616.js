(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9831:function(e,t,n){Promise.resolve().then(n.bind(n,4516))},4516:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var i=n(7437),r=n(2265),o=n(3053);let l="https://qxrnizppokxfjqaebdvp.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF4cm5penBwb2t4ZmpxYWViZHZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE1ODk4MTksImV4cCI6MjA4NzE2NTgxOX0.-hl3Y3aS4cPkBsk4M5CeL6yIHK5eUJfeB7Oh5grGnw0",s=l&&a?(0,o.eI)(l,a):null,d={p:"#7ba83e",pD:"#567d2a",pDD:"#3d5a1e",pL:"#d4e8b8",pLL:"#f3f9ea",w:"#fff",g50:"#fafbf8",g100:"#f0f3ec",g200:"#d8ddd0",g400:"#7a846e",g500:"#555e4a",g700:"#333b28",g900:"#1a1f14",rG:"#6a9e3a",warn:"#e6a817",err:"#d94f4f"},c=[{id:"soap",name:"\uD83D\uDCCB ASOP",prompt:"あなたは皮膚科専門の医療秘書です。以下の書き起こしテキストをカルテ形式で要約してください。\n\n【話者分離ルール】\n- 「です」「ます」「ください」等の丁寧語・指示語は医師/医療従事者の発言と判断\n- 「痛い」「かゆい」「気になる」「〜してほしい」等の訴え・希望は患者の発言と判断\n- 「塗ってください」「飲んでください」は医師の指示\n- 「塗っています」「飲んでいます」は患者の報告\n- 診断名・処方の決定は医師、症状の訴えは患者として分離\n\n【複数疾患への対応】\n- 会話中に複数の疾患・症状が話題になった場合、疾患ごとにASOPをまとめる\n- 各疾患ブロックを --- で区切る\n\n【出力フォーマット（厳守）】\n# 疾患名\nS）主訴内容\nO）所見内容\nP）計画内容\n患者情報）背景やイベント情報\n\n【複数疾患の場合の例】\n# 接触性皮膚炎\nS）両前腕の痒み\nO）紅斑性丘疹を散在性に認める\nP）リンデロン-VG軟膏 1日2回\n---\n# 足白癬\nS）足指の間がジュクジュクする\nO）第3-4趾間に浸軟・鱗屑\nP）ルリコン液 1日1回\n\n【フォーマットの厳密なルール】\n- # の後に半角スペース1つ、その後に疾患名のみ\n- S）O）P）患者情報）の直後に内容を続ける（改行しない）\n- 各行の間に空行を入れない\n- イベント情報（結婚式・旅行等）は患者情報）に記載\n- 会話にない情報は推測しない\n- 会話に含まれない項目は出力しない（「言及なし」と書かない）\n- コンパクトに詰めて記載"},{id:"disease",name:"\uD83C\uDFE5 疾患名",prompt:"皮膚科専門の医療秘書として疾患情報を抽出。話者分離：丁寧語・指示語は医師、訴え・希望は患者。\n\n【出力フォーマット（厳守）】\n■ 疾患名（正式医学用語。複数あれば改行で列挙）\n■ 部位\n■ 重症度・範囲\n■ 既往歴\n■ 鑑別診断（医師が言及した場合のみ）\n\n俗称は正式名称に変換（水虫→足白癬、ニキビ→ざ瘡）。推測しない。コンパクトに。"},{id:"cosmetic",name:"✨ 美容",prompt:"美容皮膚科専門の医療秘書として施術記録を要約。話者分離：丁寧語・指示語は医師、訴え・希望は患者。\n\n【出力フォーマット（厳守）】\n■ 施術名\n■ 施術部位\n■ 患者の希望・主訴\n■ 施術内容・パラメータ\n■ 使用薬剤・機器\n■ 施術後注意事項\n■ 次回予定\n■ 患者情報（イベント等）\n\n施術機器名は正式名称（ノーリス、ポテンツァ、メソナJ、MIINレーザー、AGNES）。コンパクトに。"},{id:"procedure",name:"\uD83D\uDD27 処置",prompt:"皮膚科専門の医療秘書として処置記録を要約。話者分離：丁寧語・指示語は医師、訴え・希望は患者。\n\n【出力フォーマット（厳守）】\n■ 処置名\n■ 部位・範囲\n■ 麻酔（種類・量）\n■ 処置内容（時系列）\n■ 使用器具・材料\n■ 検体提出\n■ 術後指示・処方\n■ 次回予定\n\nサイズmm、量mL/g。コンパクトに。"},{id:"followup",name:"\uD83D\uDD04 経過",prompt:"皮膚科専門の医療秘書として経過記録を要約。話者分離：丁寧語・指示語は医師、訴え・希望は患者。複数疾患があれば疾患ごとにまとめ、---で区切る。\n\n【出力フォーマット（厳守）】\n■ 疾患名\n■ 前回からの経過\n■ 現在の症状（患者）\n■ 現在の所見（医師）\n■ 治療効果判定（改善/不変/悪化）\n■ 今後の方針\n■ 次回予定\n\n前回比較を明確に。コンパクトに。"},{id:"free",name:"\uD83D\uDCDD フリー",prompt:"皮膚科専門の医療秘書として簡潔に要約。話者分離：丁寧語・指示語は医師、訴え・希望は患者。医学用語は正式名称。時系列で整理。推測しない。コンパクトに。"}],p=[{id:"r1",l:"診察室1",i:"1"},{id:"r2",l:"診察室2",i:"2"},{id:"r3",l:"診察室3",i:"3"},{id:"r4",l:"施術室1",i:"①"},{id:"r5",l:"施術室2",i:"②"},{id:"r6",l:"施術室3",i:"③"},{id:"r7",l:"カウンセリング",i:"\uD83D\uDCAC"}],u=[["りんでろん","リンデロン"],["リンデロンVG","リンデロン-VG"],["りんでろんぶいじー","リンデロン-VG"],["アンテベート","アンテベート"],["でるもべーと","デルモベート"],["ロコイド","ロコイド"],["プロトピック","プロトピック"],["キンダベート","キンダベート"],["ヒルドイド","ヒルドイド"],["ひるどいど","ヒルドイド"],["プロペト","プロペト"],["アクアチム","アクアチムクリーム"],["ダラシン","ダラシンTゲル"],["ゼビアックス","ゼビアックスローション"],["デュアック","デュアック配合ゲル"],["べピオ","ベピオゲル"],["エピデュオ","エピデュオゲル"],["ディフェリン","ディフェリンゲル"],["アダパレン","アダパレン"],["イソトレチノイン","イソトレチノイン"],["いそとれちのいん","イソトレチノイン"],["トラネキサム酸","トラネキサム酸"],["とらねきさむさん","トラネキサム酸"],["ハイドロキノン","ハイドロキノン"],["トレチノイン","トレチノイン"],["デュピクセント","デュピクセント"],["でゅぴくせんと","デュピクセント"],["ミチーガ","ミチーガ"],["オルミエント","オルミエント"],["リンヴォック","リンヴォック"],["サイバインコ","サイバインコ"],["コレクチム","コレクチム軟膏"],["モイゼルト","モイゼルト軟膏"],["ルミセフ","ルミセフ"],["コセンティクス","コセンティクス"],["スキリージ","スキリージ"],["トルツ","トルツ"],["オテズラ","オテズラ"],["ソーティクツ","ソーティクツ"],["ゾレア","ゾレア"],["ビラノア","ビラノア"],["デザレックス","デザレックス"],["ルパフィン","ルパフィン"],["アレグラ","アレグラ"],["あとぴー","アトピー性皮膚炎"],["かんせん","乾癬"],["じんましん","蕁麻疹"],["たいじょうほうしん","帯状疱疹"],["はくせん","白癬"],["ふんりゅう","粉瘤"],["しろうせい","脂漏性皮膚炎"],["しゅさ","酒さ"],["ほうかしきえん","蜂窩織炎"],["とびひ","伝染性膿痂疹"],["にきび","ざ瘡"],["ニキビ","ざ瘡"],["かんぱん","肝斑"],["そばかす","雀卵斑"],["ノーリス","ノーリス（IPL光治療）"],["のーりす","ノーリス（IPL光治療）"],["ポテンツァ","ポテンツァ"],["ぽてんつぁ","ポテンツァ"],["ジュベルック","ジュベルック"],["じゅべるっく","ジュベルック"],["メソナJ","メソナJ"],["めそな","メソナJ"],["AGNES","AGNES"],["あぐねす","AGNES"],["MIIN","MIINレーザー"],["みいん","MIINレーザー"],["美人レーザー","MIINレーザー"],["サリチル酸マクロゴールピーリング","サリチル酸マクロゴールピーリング"],["マッサージピール","マッサージピール"],["リバースピール","リバースピール"],["ゼオスキン","ゼオスキンヘルス"],["ぜおすきん","ゼオスキンヘルス"],["ミラミン","ミラミン"],["ミラミックス","ミラミックス"],["カレシム","カレシム美容液"],["ドロップスクリーン","ドロップスクリーン"],["どろっぷすくりーん","ドロップスクリーン"],["えーじーえー","AGA（男性型脱毛症）"],["エキシマ","エキシマライト"],["ナローバンド","ナローバンドUVB"],["液体窒素","液体窒素凍結療法"],["えきたいちっそ","液体窒素凍結療法"],["生検","皮膚生検"],["せいけん","皮膚生検"],["ひるまいど","ヒルドイド"],["ひるまいどローション","ヒルドイドローション"],["でゅぴくせんと","デュピクセント"],["デュピクセント注射","デュピクセント皮下注"],["おてずら","オテズラ"],["じぇんとるまっくす","ジェントルマックスプロプラス"],["じぇんとる","ジェントルマックスプロプラス"],["ジェントルマックス","ジェントルマックスプロプラス"],["トライフィル","トライフィルプロ"],["とらいふぃる","トライフィルプロ"],["キュアジェット","キュアジェット"],["きゅあじぇっと","キュアジェット"],["ターゲットクール","ターゲットクール"],["たーげっとくーる","ターゲットクール"],["ブルーレーザー","ブルーレーザー"],["ぶるーれーざー","ブルーレーザー"],["プラズマペン","プラズマペン"],["ぷらずまぺん","プラズマペン"],["スキンマリア","スキンマリア"],["すきんまりあ","スキンマリア"],["あざくりあ","AZAクリアクリーム"],["AZAクリア","AZAクリアクリーム"],["スキンピールバー","スキンピールバー"],["すきんぴーるばー","スキンピールバー"],["ナディカル","ナディカルフェイスローション"],["なでぃかる","ナディカルフェイスローション"],["えすえーしー","S-ACクリーム"],["SAC","S-ACクリーム"],["ステムアドバンス","DRXステムアドバンスセラム"],["すてむあどばんす","DRXステムアドバンスセラム"],["デイリーPD","デイリーPD"],["でいりーぴーでぃー","デイリーPD"],["バランサートナー","バランサートナー"],["ばらんさーとなー","バランサートナー"],["リバースピール","リバースピール"],["りばーすぴーる","リバースピール"],["ぼとっくす","ボトックス"],["ボトックス注射","ボトックス注"],["ひあるろんさん","ヒアルロン酸"],["ヒアルロン酸注入","ヒアルロン酸注入"],["しみとり","シミ取りレーザー"],["ほくろとり","ホクロ除去"],["だーまぺん","ダーマペン"],["ダーマペン","ダーマペン4"],["うるせら","ウルセラ"],["ハイフ","HIFU"],["はいふ","HIFU"],["しーおーつーれーざー","CO2レーザー"],["炭酸ガスレーザー","CO2レーザー"],["ていれーざー","T字レーザー"],["フラクショナル","フラクショナルレーザー"],["ふらくしょなる","フラクショナルレーザー"],["ケミカルピーリング","ケミカルピーリング"],["けみかるぴーりんぐ","ケミカルピーリング"],["いおんとふぉれーしす","イオントフォレーシス"],["イオン導入","イオントフォレーシス"],["えれくとろぽれーしょん","エレクトロポレーション"],["電気穿孔法","エレクトロポレーション"],["ぴこれーざー","ピコレーザー"],["ぴことーにんぐ","ピコトーニング"],["きゅーすいっち","Qスイッチレーザー"],["Qスイッチ","Qスイッチレーザー"],["びたみんしー","ビタミンC誘導体"],["びたみんC","ビタミンC誘導体"],["れちのーる","レチノール"],["せらみど","セラミド"],["ないあしんあみど","ナイアシンアミド"],["りどかいん","リドカイン"],["きしろかいん","キシロカイン"],["ペンレス","ペンレステープ"],["ぺんれす","ペンレステープ"],["エムラ","エムラクリーム"],["えむら","エムラクリーム"],["SPF","SPF"],["ぴーえー","PA"],["りょうせいしゅよう","良性腫瘍"],["あくせいしゅよう","悪性腫瘍"],["きていさいぼうがん","基底細胞癌"],["ゆうきょくさいぼうがん","有棘細胞癌"],["あくせいこくしょくしゅ","悪性黒色腫"],["メラノーマ","悪性黒色腫"],["めらのーま","悪性黒色腫"],["けろいど","ケロイド"],["ひこうせいはんこん","肥厚性瘢痕"],["ただ","ただれ（びらん）"],["びらん","びらん"],["ほっしん","発疹"],["こうはん","紅斑"],["きゅうしん","丘疹"],["すいほう","水疱"],["のうほう","膿疱"],["りんせつ","鱗屑"],["かひ","痂皮"],["あとぴー","アトピー性皮膚炎"],["あとぴーせいひふえん","アトピー性皮膚炎"],["しろせいひふえん","脂漏性皮膚炎"],["しろせい","脂漏性"],["じんましん","蕁麻疹"],["じんましん","蕁麻疹"],["かんぱん","肝斑"],["そばかす","雀卵斑"],["たいじょうほうしん","帯状疱疹"],["たいじょう","帯状疱疹"],["ヘルペス","単純ヘルペス"],["へるぺす","単純ヘルペス"],["みずぼうそう","水痘"],["とびひ","伝染性膿痂疹"],["みずいぼ","伝染性軟属腫"],["にきび","ざ瘡"],["ニキビ","ざ瘡"],["にきびあと","ざ瘡瘢痕"],["ニキビ跡","ざ瘡瘢痕"],["にきび痕","ざ瘡瘢痕"],["しゅさ","酒さ"],["しゅさようひふえん","酒さ様皮膚炎"],["くちまわりひふえん","口囲皮膚炎"],["かんせん","乾癬"],["じょうじょうせいかんせん","尋常性乾癬"],["てきじょう","滴状乾癬"],["しょうせきのうほうしょう","掌蹠膿疱症"],["しょうせき","掌蹠膿疱症"],["えんけいだつもうしょう","円形脱毛症"],["だつもうしょう","脱毛症"],["AGA","男性型脱毛症"],["はくはん","白斑"],["じんじょうせいはくはん","尋常性白斑"],["しみ","色素沈着"],["くすみ","色素沈着"],["ほくろ","色素性母斑"],["あざ","母斑"],["いぼ","疣贅"],["じんじょうせいゆうぜい","尋常性疣贅"],["ウイルス性イボ","ウイルス性疣贅"],["ふんりゅう","粉瘤（アテローム）"],["あてろーむ","粉瘤（アテローム）"],["ひのうほう","皮膚嚢腫"],["たこ","胼胝"],["うおのめ","鶏眼"],["べんち","胼胝"],["けいがん","鶏眼"],["まきづめ","巻き爪"],["かんにゅうそう","陥入爪"],["みずむし","足白癬"],["たむし","体部白癬"],["いんきんたむし","股部白癬"],["つめみずむし","爪白癬"],["ひふか","皮膚科"],["びようひふか","美容皮膚科"],["すてろいど","ステロイド外用薬"],["ステロイド","ステロイド外用薬"],["でるもべーと","デルモベート"],["あんてべーと","アンテベート"],["まいざー","マイザー"],["りんでろん","リンデロン"],["ろこいど","ロコイド"],["きんだべーと","キンダベート"],["ぷろとぴっく","プロトピック"],["たくろりむす","タクロリムス"],["これくちむ","コレクチム"],["もいぜると","モイゼルト"],["ひるどいど","ヒルドイド"],["わせりん","白色ワセリン"],["プロペト","プロペト（白色ワセリン）"],["べぴおげる","ベピオゲル"],["でぃふぇりん","ディフェリン"],["えぴでゅお","エピデュオ"],["でゅあっく","デュアック"],["あだぱれん","アダパレン"],["くりんだまいしん","クリンダマイシン"],["あくあちむ","アクアチム"],["ぜびあっくす","ゼビアックス"],["なじふろ","ナジフロ"],["でるもぞーる","デルモゾール"],["にぞらーる","ニゾラール"],["るりこん","ルリコン"],["てるびなふぃん","テルビナフィン"],["いとらこなぞーる","イトラコナゾール"],["ふぇきそふぇなじん","フェキソフェナジン"],["あれぐら","アレグラ"],["びらのあ","ビラノア"],["でざれっくす","デザレックス"],["るぱふぃん","ルパフィン"],["たりおん","タリオン"],["あれろっく","アレロック"],["ざいざる","ザイザル"],["ばるとれっくす","バルトレックス"],["あめなりーふ","アメナリーフ"],["ばらしくろびる","バラシクロビル"],["よくいにん","ヨクイニン"],["はとむぎ","ヨクイニン"],["めととれきさーと","メトトレキサート"],["しくろすぽりん","シクロスポリン"],["ねおーらる","ネオーラル"],["かろなーる","カロナール"],["あせとあみのふぇん","アセトアミノフェン"],["ろきそにん","ロキソニン"],["りりか","リリカ"],["たりーじぇ","タリージェ"],["ぷれがばりん","プレガバリン"],["みろがばりん","ミロガバリン"],["あずのーる","アズノール"],["げんたしん","ゲンタシン"],["ふしじんさん","フシジン酸"]];function g(){let[e,t]=(0,r.useState)("main"),[n,o]=(0,r.useState)("inactive"),[l,a]=(0,r.useState)(""),[g,x]=(0,r.useState)(""),[h,f]=(0,r.useState)("待機中"),[m,y]=(0,r.useState)(0),[b,D]=(0,r.useState)(!1),[j,S]=(0,r.useState)(0),[v,w]=(0,r.useState)("gemini"),[C,k]=(0,r.useState)(0),[z,I]=(0,r.useState)("soap"),[B,F]=(0,r.useState)("r1"),[R,W]=(0,r.useState)([]),[A,E]=(0,r.useState)(""),[L,T]=(0,r.useState)(""),[_,P]=(0,r.useState)(""),[O,M]=(0,r.useState)(null),[N,J]=(0,r.useState)(!1),[G,H]=(0,r.useState)(u),[U,V]=(0,r.useState)(""),[q,Z]=(0,r.useState)(""),[X,Q]=(0,r.useState)(!0),[Y,K]=(0,r.useState)(""),[$,ee]=(0,r.useState)(32);(0,r.useEffect)(()=>{try{let e=localStorage.getItem("mk_logo");e&&K(e);let t=localStorage.getItem("mk_logoSize");t&&ee(parseInt(t));let n=localStorage.getItem("mk_dict");n&&H(JSON.parse(n));let i=localStorage.getItem("mk_snippets");i&&es(JSON.parse(i));let r=localStorage.getItem("mk_pipSnippets");r&&ex(JSON.parse(r));let o=localStorage.getItem("mk_audioSave");o&&eP("1"===o);let l=localStorage.getItem("mk_dictEnabled");l&&Q("1"===l)}catch(e){}},[]);let[et,en]=(0,r.useState)([]),[ei,er]=(0,r.useState)(""),eo=async()=>{try{await navigator.mediaDevices.getUserMedia({audio:!0}).then(e=>e.getTracks().forEach(e=>e.stop()));let e=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind);en(e),!ei&&e.length>0&&er(e[0].deviceId)}catch(e){console.error("Mic enumeration error:",e)}};(0,r.useEffect)(()=>(eo(),navigator.mediaDevices.addEventListener("devicechange",eo),()=>navigator.mediaDevices.removeEventListener("devicechange",eo)),[]),(0,r.useEffect)(()=>{if(!document.getElementById("spin-kf")){let e=document.createElement("style");e.id="spin-kf",e.textContent="@keyframes spin{to{transform:rotate(360deg)}}",document.head.appendChild(e)}},[]);let el=[{title:"f/u 1w",text:"f/u 1w後（1週間後再診）",cat:"フォロー"},{title:"f/u 2w",text:"f/u 2w後（2週間後再診）",cat:"フォロー"},{title:"f/u 4w",text:"f/u 4w後（4週間後再診）",cat:"フォロー"},{title:"f/u 2M",text:"f/u 2M後（2ヶ月後再診）",cat:"フォロー"},{title:"f/u 3M",text:"f/u 3M後（3ヶ月後再診）",cat:"フォロー"},{title:"経過観察",text:"経過観察。症状増悪時は早めに再診。",cat:"フォロー"},{title:"処方箋発行",text:"処方箋発行済み",cat:"記録"},{title:"説明同意",text:"治療内容・リスク・副作用について説明し、同意を得た。",cat:"記録"},{title:"写真撮影",text:"臨床写真撮影済み",cat:"記録"},{title:"紹介状",text:"紹介状作成：　病院　科宛",cat:"記録"},{title:"検査オーダー",text:"検査オーダー：血液検査（CBC, CRP）",cat:"記録"},{title:"アレルギー検査",text:"ドロップスクリーン（41種アレルギー検査）施行",cat:"記録"},{title:"皮膚生検",text:"皮膚生検施行。検体を病理組織検査に提出。結果は約2週間後。",cat:"記録"},{title:"粉瘤切除",text:"【手術記録】粉瘤摘出術\n部位：\nサイズ：約 mm\n麻酔：1%キシロカイン（エピ入り） mL局注\n術式：紡錘形切開にて被膜ごと摘出\n止血確認後、 -0ナイロンにて縫合（ 針）\n検体：病理提出\n術後：ゲンタシン軟膏+ガーゼ保護\n抜糸予定：7-10日後",cat:"手術"},{title:"皮膚腫瘍切除",text:"【手術記録】皮膚腫瘍切除術\n部位：\n臨床診断：\nサイズ：約 mm（マージン mm含む）\n麻酔：1%キシロカイン（エピ入り） mL局注\n術式：マーキング後、紡錘形に切除\n止血確認後、真皮縫合+ -0ナイロンにて縫合\n検体：病理提出\n術後：ガーゼ保護\n抜糸予定：7-14日後",cat:"手術"},{title:"切開排膿",text:"【手術記録】切開排膿術\n部位：\n麻酔：1%キシロカイン mL局注\n所見：膿汁排出あり、内容物を十分に排出\nドレナージ：ガーゼドレーン挿入\n術後：ゲンタシン軟膏+ガーゼ保護、毎日洗浄交換\n抗生剤処方：",cat:"手術"},{title:"液体窒素",text:"液体窒素凍結療法施行\n部位：\n回数：　回（各 秒程度）\n対象：尋常性疣贅\nf/u 2w後",cat:"処置"},{title:"光線（NB-UVB）",text:"ナローバンドUVB照射\n照射量： mJ/cm\xb2\n部位：\n回数：本日 回目\n皮膚反応：紅斑（-/\xb1/+）\n次回照射量：　mJ/cm\xb2に増量予定",cat:"処置"},{title:"光線（エキシマ）",text:"エキシマライト照射\n照射量： mJ/cm\xb2\n部位：\n回数：本日 回目\n皮膚反応：紅斑（-/\xb1/+）\n次回照射量：　mJ/cm\xb2",cat:"処置"},{title:"デュピクセント",text:"デュピクセント皮下注射施行\n投与量：300mg（初回のみ600mg）\n投与部位：\n副作用確認：注射部位反応（-）、結膜炎（-）\n次回投与：2w後\nEASIスコア：",cat:"生物学的製剤"},{title:"ミチーガ",text:"ミチーガ皮下注射施行\n投与量：60mg\n投与部位：\n副作用確認：注射部位反応（-）\n次回投与：4w後",cat:"生物学的製剤"},{title:"コセンティクス",text:"コセンティクス皮下注射施行\n投与量：150mg/300mg\n投与部位：\n副作用確認：注射部位反応（-）\n次回投与：（初期は毎週→4w後）\nPASIスコア：",cat:"生物学的製剤"},{title:"ゾレア",text:"ゾレア皮下注射施行\n投与量：300mg\n投与部位：\n副作用確認：注射部位反応（-）、アナフィラキシー（-）\n次回投与：4w後\nUAS7スコア：",cat:"生物学的製剤"},{title:"スキリージ",text:"スキリージ皮下注射施行\n投与量：150mg\n投与部位：\n副作用確認：注射部位反応（-）\n次回投与：（初期12w→8w後）\nPASIスコア：",cat:"生物学的製剤"},{title:"ノーリス",text:"ノーリス（IPL光治療）施行\n照射部位：顔全体\nフィルター：\nフルエンス：\nパス数：\n冷却：施行\n術後：日焼け止め塗布・保湿指導",cat:"美容施術"},{title:"ポテンツァ",text:"ポテンツァ施行\nチップ：\n部位：\n出力：\nパス数：\n麻酔：表面麻酔クリーム（ mm塗布 分待機）\n術後：鎮静パック施行、保湿・遮光指導",cat:"美容施術"},{title:"メソナJ",text:"メソナJ施行\nコース：トータル美容/美肌コース\n導入成分：\n部位：顔全体（目元含む）\n施術時間：約 分\n術後：特記事項なし",cat:"美容施術"},{title:"ピーリング",text:"サリチル酸マクロゴールピーリング施行\n部位：顔全体\n塗布時間：5分\n皮膚反応：軽度発赤（\xb1）\n術後：保湿・遮光指導",cat:"美容施術"},{title:"外用指導",text:"外用指導：1日2回（朝・入浴後）患部に薄く塗布。改善後は1日1回に減量可。",cat:"患者指導"},{title:"保湿指導",text:"保湿指導：1日2回以上、入浴後すぐに保湿剤を全身に塗布。こすらず押さえるように。",cat:"患者指導"},{title:"遮光指導",text:"遮光指導：日焼け止め（SPF30以上）を毎日塗布。2-3時間おきに塗り直し。",cat:"患者指導"},{title:"外用FTU",text:"外用量目安（FTU）：人差し指の先端から第一関節まで（約0.5g）で手のひら2枚分の面積に塗布。",cat:"患者指導"},{title:"重ね塗り順序",text:"外用順序：①保湿剤を広範囲に塗布→②ステロイド外用薬を患部のみに重ね塗り",cat:"患者指導"},{title:"プロアクティブ",text:"プロアクティブ療法：症状改善後も週2-3回の外用を継続。再燃予防のため自己判断で中止しない。徐々に週1回→隔週と間隔を延長。",cat:"患者指導"},{title:"ステロイド漸減",text:"ステロイド漸減：\n1-2週目：1日2回\n3-4週目：1日1回\n5-6週目：2日に1回\n以降：週2-3回（プロアクティブ療法へ移行）",cat:"患者指導"},{title:"抗ヒス内服指導",text:"抗ヒスタミン薬：毎日決まった時間に服用。症状なくても自己判断で中止せず継続。眠気あれば就寝前に服用。",cat:"患者指導"},{title:"帯状疱疹指導",text:"帯状疱疹指導：抗ウイルス薬5-7日間確実に内服。水疱は清潔に保ち破らない。疼痛持続時は早めに相談。水痘未罹患の乳幼児・妊婦との接触を避ける。",cat:"患者指導"},{title:"術後注意（縫合）",text:"術後注意（縫合創）：\n・当日は安静、飲酒・激しい運動控える\n・翌日からシャワー可（洗浄後、軟膏+ガーゼ保護）\n・湯船は抜糸まで不可\n・出血時は清潔なガーゼで圧迫し連絡\n・抜糸予定：　日後",cat:"術後注意"},{title:"術後注意（切開）",text:"術後注意（切開排膿後）：\n・毎日シャワーで洗浄→軟膏+ガーゼ交換\n・膿や浸出液は正常な経過\n・発熱・腫れ拡大時は早めに受診\n・抗生剤は最後まで内服",cat:"術後注意"},{title:"施術後（レーザー）",text:"施術後注意（レーザー）：\n・赤み腫れは数日で改善\n・24h洗顔・化粧控える\n・かさぶたを剥がさない\n・日焼け止め必須\n・保湿十分に\n・こすらない（色素沈着予防）",cat:"術後注意"},{title:"施術後（IPL）",text:"施術後注意（ノーリス/IPL）：\n・シミが一時的に濃くなる→1-2wで剥がれる\n・当日から洗顔メイク可\n・日焼け止め必須\n・1w刺激の強い化粧品を避ける",cat:"術後注意"},{title:"施術後（ポテンツァ）",text:"施術後注意（ポテンツァ）：\n・赤み腫れ点状出血→2-3日で改善\n・当日洗顔メイク不可、翌日から可\n・24h飲酒・運動・入浴控える\n・日焼け止め必須",cat:"術後注意"},{title:"施術後（ピーリング）",text:"施術後注意（ピーリング）：\n・当日から洗顔メイク可\n・数日間皮むけ乾燥あり\n・保湿十分に・日焼け止め必須\n・1wスクラブ使用不可",cat:"術後注意"},{title:"ゼオスキン開始",text:"ゼオスキンヘルス開始\nコース：\n製品：\n注意：A反応（赤み皮むけ乾燥）は2-6wで改善。日焼け止め必須。妊娠授乳中はトレチノイン使用不可。",cat:"その他"},{title:"イソトレチノイン",text:"イソトレチノイン内服開始　mg/日\n注意：避妊必須（女性：前1M〜後1M）、献血不可、定期血液検査（肝機能・脂質）、保湿（唇・皮膚・眼の乾燥対策）\n次回血液検査：4w後",cat:"その他"},{title:"帯状疱疹ワクチン",text:"帯状疱疹ワクチン（シングリックス）説明：\n・不活化ワクチン、2回接種（2ヶ月間隔）\n・予防効果90%以上、50歳以上対象\n・接種部位の痛み腫れは数日で改善",cat:"その他"}],[ea,es]=(0,r.useState)(el),[ed,ec]=(0,r.useState)(""),[ep,eu]=(0,r.useState)(""),[eg,ex]=(0,r.useState)([0,1,2,3,4]),[eh,ef]=(0,r.useState)([]),[em,ey]=(0,r.useState)(""),[eb,eD]=(0,r.useState)(""),[ej,eS]=(0,r.useState)(!1),[ev,ew]=(0,r.useState)(""),[eC,ek]=(0,r.useState)("inactive"),[ez,eI]=(0,r.useState)(""),[eB,eF]=(0,r.useState)(""),[eR,eW]=(0,r.useState)(!1),[eA,eE]=(0,r.useState)(0),[eL,eT]=(0,r.useState)(""),[e_,eP]=(0,r.useState)(!1),[eO,eM]=(0,r.useState)([]),[eN,eJ]=(0,r.useState)(""),eG=(0,r.useRef)(!1),eH=(0,r.useRef)([]);(0,r.useEffect)(()=>{eG.current=e_},[e_]);let eU=async e=>{if(s&&e&&!(e.size<1e3))try{let t=new Date().toISOString().replace(/[:.]/g,"-"),n="audio/".concat(B,"/").concat(t,"_").concat(e4.current||"unknown",".webm"),{error:i}=await s.storage.from("audio").upload(n,e,{contentType:"audio/webm"});i?console.error("Audio save error:",i):console.log("Audio saved:",n)}catch(e){console.error("Audio save error:",e)}},eV=(0,r.useRef)(null),eq=(0,r.useRef)(null),eZ=(0,r.useRef)(null),eX=(0,r.useRef)(null),eQ=(0,r.useRef)(null),eY=(0,r.useRef)(null),eK=(0,r.useRef)(null),e$=(0,r.useRef)(""),e0=(0,r.useRef)(null),e1=(0,r.useRef)(0),e2=(0,r.useRef)(0),e3=(0,r.useRef)("inactive"),e5=(0,r.useRef)(""),e4=(0,r.useRef)(""),e8=(0,r.useRef)(el),e6=(0,r.useRef)([0,1,2,3,4]);(0,r.useEffect)(()=>{e$.current=l},[l]),(0,r.useEffect)(()=>{e1.current=m},[m]),(0,r.useEffect)(()=>{e2.current=j},[j]),(0,r.useEffect)(()=>{e3.current=n},[n]),(0,r.useEffect)(()=>{e5.current=L},[L]),(0,r.useEffect)(()=>{e4.current=_},[_]),(0,r.useEffect)(()=>{e8.current=ea},[ea]),(0,r.useEffect)(()=>{e6.current=eg},[eg]),(0,r.useEffect)(()=>("recording"===n?eY.current=setInterval(()=>y(e=>e+1),1e3):(clearInterval(eY.current),"inactive"===n&&y(0)),()=>clearInterval(eY.current)),[n]),(0,r.useEffect)(()=>{let e=setInterval(()=>{if(!e0.current)return;let e=e0.current,t=e.getElementById("pip-timer"),n=e.getElementById("pip-level"),i=e.getElementById("pip-status"),r=e.getElementById("pip-transcript");if(t){let e=e1.current;t.textContent="".concat(String(Math.floor(e/60)).padStart(2,"0"),":").concat(String(e%60).padStart(2,"0"))}if(n&&(n.style.width="".concat(e2.current,"%")),i){let e=e3.current;i.textContent="recording"===e?"録音中":"paused"===e?"一時停止":"停止",i.style.color="recording"===e?d.rG:"paused"===e?d.warn:d.g400}if(r){let e=e$.current;if(e){let t=e.split("\n");r.textContent=t[t.length-1]}else r.textContent=""}},500);return()=>clearInterval(e)},[]);let e7=c.find(e=>e.id===z)||c[0];p.find(e=>e.id===B);let e9=async(e,t)=>{if(s)try{await s.from("records").insert({room:B,template:z,ai_model:v,input_text:e,output_text:t,patient_name:e5.current,patient_id:e4.current})}catch(e){console.error("Save error:",e)}},te=async()=>{if(em.trim()){eS(!0),eD("");try{let e=[];if(s){let{data:t}=await s.from("records").select("output_text").order("created_at",{ascending:!1}).limit(200);t&&(e=t.map(e=>e.output_text).filter(Boolean))}let t=e.filter(e=>e.includes(em)).slice(0,20),n=t.length>0?t.join("\n---\n"):"",i="あなたは皮膚科専門医です。以下の疾患/テーマについて患者向けの説明資料を作成してください。\n【疾患名/テーマ】".concat(em,"\n").concat(ev?"【追加指示】".concat(ev,"\n"):"").concat(n?"【当院の過去の診療記録（参考）】\n"+n+"\n":"","\n以下の構成で患者さんにわかりやすく作成：\n1. 疾患の概要（どんな病気か、原因）\n2. 症状\n3. 当院での治療方法（過去記録がある場合、当院で使用されている薬剤・施術を優先して記載）\n4. 外用薬の使い方（該当する場合、FTU・塗り方・頻度・重ね塗り順序を含む）\n5. 日常生活での注意点・スキンケア\n6. 治療スケジュール・通院頻度の目安\n7. 術後・施術後の注意点（該当する場合）\n8. よくある質問（Q&A 2-3個）\n※過去記録がある場合、当院で実際に使用されている薬剤名・施術名・治療プロトコルを反映\n※専門用語は噛み砕いて説明\n※美容施術の場合はカウンセリング用に効果・ダウンタイム・施術間隔も含める\n※外用方法が関係する場合はFTU（1FTU=約0.5g）、塗布順序（保湿剤→ステロイド等）、プロアクティブ療法についても記載\n※手術後の注意点が関係する場合はシャワー・入浴・抜糸・出血時の対応も記載"),r=await fetch("/api/summarize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:i,mode:"gemini",prompt:"以下の指示に従って患者向け説明資料を作成してください。"})}),o=await r.json();o.error?eD("エラー: "+o.error):eD(o.summary)}catch(e){eD("エラー: "+e.message)}finally{eS(!1)}}},tt=(0,r.useRef)(null),tn=(0,r.useRef)(null),ti=(0,r.useRef)(null),tr=(0,r.useRef)(null);ti.current=ez;let to=async()=>{let e=await tu();if(!e)return;let t=new MediaRecorder(e,{mimeType:"audio/webm;codecs=opus"});tt.current=t;let n=[];t.ondataavailable=e=>{e.data.size>0&&n.push(e.data)},t.onstop=async()=>{if(n.length>0){let e=new Blob(n,{type:"audio/webm"});if(n=[],!(e.size<500))try{let t=new FormData;t.append("audio",e,"audio.webm");let n=await fetch("/api/transcribe",{method:"POST",body:t}),i=await n.json();i.text&&i.text.trim()&&eI(e=>e+(e?"\n":"")+i.text.trim())}catch(e){}}},t.start(),ek("recording"),eE(0),tr.current=setInterval(()=>{eE(e=>e+1),tt.current&&"recording"===tt.current.state&&(tt.current.stop(),setTimeout(()=>{tt.current&&"inactive"!==tn.current&&tt.current.start()},200))},1e4)},tl=()=>{tr.current&&clearInterval(tr.current),tt.current&&"recording"===tt.current.state&&tt.current.stop(),ek("inactive"),tn.current="inactive",tg()},ta=async()=>{var e;if(tl(),!(null===(e=ti.current)||void 0===e?void 0:e.trim()))return;eW(!0);let t=eL.trim()||"以下の会議・ミーティングの書き起こしから議事録を作成してください。",n="".concat(t,"\n\n【書き起こし内容】\n").concat(ti.current,"\n\n以下の構成で簡潔にまとめてください：\n1. 日時・参加者（わかる場合）\n2. 議題・アジェンダ\n3. 決定事項\n4. 各議題の要点\n5. アクションアイテム（担当者・期限）\n6. 次回予定");try{let e=await fetch("/api/summarize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,mode:"gemini",prompt:"議事録を作成してください。"})}),t=await e.json();t.error?eF("エラー: "+t.error):eF(t.summary)}catch(e){eF("エラー: "+e.message)}finally{eW(!1)}};(0,r.useEffect)(()=>{tn.current=eC},[eC]);let ts=async()=>{if(s)try{let{data:e}=await s.from("records").select("*").order("created_at",{ascending:!1}).limit(50);e&&W(e)}catch(e){console.error("Load error:",e)}},td=async e=>{if(s)try{await s.from("records").delete().eq("id",e),W(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Delete error:",e)}},tc=R.filter(e=>{if(!A.trim())return!0;let t=A.toLowerCase();return(e.patient_name||"").toLowerCase().includes(t)||(e.patient_id||"").toLowerCase().includes(t)||(e.output_text||"").toLowerCase().includes(t)}),tp=e=>{if(!X||!e)return e;let t=e;for(let[e,n]of G)e&&n&&e!==n&&(t=t.split(e).join(n));return t},tu=async()=>{try{let e=await navigator.mediaDevices.getUserMedia(ei?{audio:{deviceId:{exact:ei}}}:{audio:!0});eq.current=e;let t=new(window.AudioContext||window.webkitAudioContext),n=t.createMediaStreamSource(e),i=t.createAnalyser();i.fftSize=256,i.smoothingTimeConstant=.7,n.connect(i),eZ.current=t,eX.current=i;let r=new Uint8Array(i.frequencyBinCount),o=()=>{if(!eX.current)return;eX.current.getByteFrequencyData(r);let e=0;for(let t=0;t<r.length;t++)e+=r[t];S(Math.min(100,Math.round(e/r.length/128*100))),eQ.current=requestAnimationFrame(o)};return eQ.current=requestAnimationFrame(o),e}catch(e){return console.error("Mic error:",e),f("マイク取得失敗：ブラウザの許可設定を確認してください"),null}},tg=()=>{if(eQ.current&&cancelAnimationFrame(eQ.current),eQ.current=null,eZ.current)try{eZ.current.close()}catch(e){}eZ.current=null,eq.current&&eq.current.getTracks().forEach(e=>e.stop()),eq.current=null,eX.current=null,S(0)},tx=async e=>{if(!(e.size<500)){eG.current&&eH.current.push(e),k(e=>e+1),f("\uD83D\uDD04 書き起こし中...");try{let t=new FormData;t.append("audio",e,"audio.webm");let n=await fetch("/api/transcribe",{method:"POST",body:t}),i=await n.json();if(i.text&&i.text.trim()){let e=tp(i.text.trim());a(t=>t+(t?"\n":"")+e),f("録音中 ✓")}else f("録音中")}catch(e){f("録音中（エラー）")}finally{k(e=>Math.max(0,e-1))}}},th=e=>{let t=new MediaRecorder(e,{mimeType:MediaRecorder.isTypeSupported("audio/webm;codecs=opus")?"audio/webm;codecs=opus":"audio/webm"});return t.ondataavailable=e=>{e.data.size>0&&tx(e.data)},t},tf=async()=>{let e=await tu();if(!e)return;o("recording"),f("録音中");let t=th(e);t.start(),eV.current=t,eK.current=setInterval(()=>{if(eV.current&&"recording"===eV.current.state){eV.current.stop();let t=th(e);t.start(),eV.current=t}},5e3)},tm=()=>{clearInterval(eK.current),eV.current&&"recording"===eV.current.state&&eV.current.stop(),eV.current=null,tg(),o("inactive"),f("待機中"),eG.current&&eH.current.length>0&&(eU(new Blob(eH.current,{type:"audio/webm"})),eH.current=[])},ty=()=>{clearInterval(eK.current),eV.current&&"recording"===eV.current.state&&eV.current.stop(),o("paused"),f("一時停止")},tb=()=>{if(!eq.current)return;o("recording"),f("録音中");let e=th(eq.current);e.start(),eV.current=e,eK.current=setInterval(()=>{if(eV.current&&"recording"===eV.current.state){eV.current.stop();let e=th(eq.current);e.start(),eV.current=e}},5e3)},tD=async e=>{let t=e||e$.current;if(!t.trim()){f("テキストを入力してください");return}D(!0),f("Gemini で要約中...");try{let e=await fetch("/api/summarize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t,mode:"gemini",prompt:e7.prompt})}),n=await e.json();if(n.error){f("エラー: "+n.error);return}x(n.summary),await e9(t,n.summary);try{await navigator.clipboard.writeText(n.summary),f("要約完了・保存済み ✓")}catch(e){f("要約完了・保存済み")}}catch(e){f("エラーが発生しました")}finally{D(!1)}},tj=()=>{if(clearInterval(eK.current),eV.current&&"recording"===eV.current.state){let e=eV.current;e.ondataavailable=async e=>{if(e.data.size>0){let t=new FormData;t.append("audio",e.data,"audio.webm");try{let e=await fetch("/api/transcribe",{method:"POST",body:t}),n=await e.json();if(n.text&&n.text.trim()){let e=e$.current+(e$.current?"\n":"")+tp(n.text.trim());a(e),setTimeout(()=>tD(e),300)}else tD()}catch(e){tD()}}else tD()},e.stop()}else tD();eV.current=null,tg(),o("inactive")},tS=()=>{a(""),x(""),f("待機中"),y(0),T(""),P("")},tv=async e=>{try{await navigator.clipboard.writeText(e),f("コピー済み ✓")}catch(e){}},tw=(0,r.useCallback)(async()=>{try{if(!("documentPictureInPicture"in window)){f("Chrome 116以降で利用可能です");return}let e=await window.documentPictureInPicture.requestWindow({width:260,height:160}),t=p.find(e=>e.id===B),n=t?"".concat(t.i).concat(t.l):"";e.document.body.style.margin="0",e.document.body.style.overflow="hidden",e.document.body.innerHTML='<div style="font-family:sans-serif;background:linear-gradient(135deg,#3d5a1e,#567d2a);color:#fff;padding:5px 8px;height:100%;box-sizing:border-box;display:flex;flex-direction:column;gap:2px">\n<div style="display:flex;align-items:center;gap:4px"><span style="font-size:9px;opacity:.5">'.concat(n,'</span>\n<input id="pip-pid" placeholder="患者ID" value="" style="flex:1;padding:1px 5px;border-radius:4px;border:none;font-size:9px;background:rgba(255,255,255,.15);color:#fff;outline:none"/>\n<span id="pip-status" style="font-size:9px;font-weight:600;color:#94a3b8">停止</span></div>\n<div style="display:flex;align-items:center;gap:6px"><div id="pip-timer" style="font-size:15px;font-weight:700;font-variant-numeric:tabular-nums">00:00</div>\n<div style="flex:1;height:3px;border-radius:2px;background:rgba(255,255,255,.12);overflow:hidden"><div id="pip-level" style="width:0%;height:100%;background:#22c55e;border-radius:2px;transition:width 0.15s"></div></div></div>\n<div id="pip-transcript" style="height:18px;overflow:hidden;border-radius:4px;background:rgba(0,0,0,.2);padding:1px 6px;font-size:9px;color:#a0c96a;white-space:nowrap;text-overflow:ellipsis"></div>\n<div style="display:flex;gap:4px;justify-content:center">\n<button id="pip-rec" style="padding:2px 14px;border-radius:8px;border:2px solid #fff;background:rgba(255,255,255,.15);color:#fff;font-size:13px;font-weight:700;cursor:pointer">開始</button>\n<button id="pip-pause" style="padding:2px 10px;border-radius:8px;border:none;background:#fbbf24;color:#78350f;font-size:13px;font-weight:700;cursor:pointer;display:none">一時停止</button>\n<button id="pip-sum" style="padding:2px 10px;border-radius:8px;border:none;background:#567d2a;color:#fff;font-size:13px;font-weight:700;cursor:pointer;display:none">要約</button>\n<button id="pip-stop" style="padding:2px 10px;border-radius:8px;border:none;background:#ef4444;color:#fff;font-size:13px;font-weight:700;cursor:pointer;display:none">停止</button>\n<button id="pip-next" style="padding:2px 12px;border-radius:8px;border:2px solid #fff;background:rgba(255,255,255,.15);color:#fff;font-size:12px;font-weight:700;cursor:pointer">次へ▶</button></div>\n<div id="pip-snippets" style="display:flex;gap:3px;flex-wrap:wrap;overflow:hidden;max-height:22px"></div></div>'),e.document.head.innerHTML="<style>::placeholder{color:rgba(255,255,255,.35)}</style>";let i=e.document.getElementById("pip-pid");i&&(i.value=_,i.addEventListener("input",e=>{P(e.target.value)}));let r=()=>{let e=e0.current;if(!e)return;let t=e3.current,n=e.getElementById("pip-rec"),i=e.getElementById("pip-pause"),r=e.getElementById("pip-stop"),o=e.getElementById("pip-sum");n&&(n.style.display="inactive"===t?"inline-block":"none",i.style.display="inactive"!==t?"inline-block":"none","recording"===t?(i.textContent="一時停止",i.style.background="#fbbf24",i.style.color="#78350f"):"paused"===t&&(i.textContent="再開",i.style.background="#22c55e",i.style.color="#fff"),r.style.display="inactive"!==t?"inline-block":"none",o.style.display="inactive"!==t?"inline-block":"none")};e.document.getElementById("pip-rec").onclick=()=>{tf(),setTimeout(r,500)},e.document.getElementById("pip-pause").onclick=()=>{"recording"===e3.current?ty():tb(),setTimeout(r,300)},e.document.getElementById("pip-stop").onclick=()=>{tm(),setTimeout(r,300)},e.document.getElementById("pip-sum").onclick=()=>{tj(),setTimeout(r,500)},e.document.getElementById("pip-next").onclick=()=>{tS();let e=e0.current;if(e){let t=e.getElementById("pip-pid");t&&(t.value="")}setTimeout(r,300)},(()=>{let e=e0.current;if(!e)return;let t=e.getElementById("pip-snippets");if(!t)return;let n=e8.current,i=e6.current,r="";i.forEach(e=>{e<n.length&&(r+='<button data-sn-idx="'.concat(e,'" style="padding:1px 6px;border-radius:5px;border:1px solid rgba(255,255,255,.4);background:rgba(255,255,255,.15);color:#fff;font-size:9px;font-weight:600;cursor:pointer">').concat(n[e].title,"</button>"))}),t.innerHTML=r,t.querySelectorAll("button").forEach(e=>{e.onclick=()=>{let t=parseInt(e.getAttribute("data-sn-idx")),n=e8.current[t];n&&x(e=>e+(e?"\n":"")+n.text)}})})(),e0.current=e.document,M(e),J(!0);let o=setInterval(()=>{if(!e0.current){clearInterval(o);return}r()},600);e.addEventListener("pagehide",()=>{clearInterval(o),e0.current=null,M(null),J(!1)})}catch(e){console.error("PiP error:",e),f("小窓を開けませんでした")}},[B,_,eg,ea]),tC=(0,r.useCallback)(()=>{O&&O.close(),e0.current=null,M(null),J(!1)},[O]),tk=e=>{let t=new Date(e);return"".concat(t.getMonth()+1,"/").concat(t.getDate()," ").concat(t.getHours(),":").concat(String(t.getMinutes()).padStart(2,"0"))},tz=e=>{let t=c.find(t=>t.id===e);return t?t.name:e},tI=e=>{let t=p.find(t=>t.id===e);return t?"".concat(t.i).concat(t.l):e},tB=(e,t,n)=>({padding:"8px 18px",borderRadius:14,border:"none",background:e,color:t,fontSize:14,fontWeight:600,fontFamily:"inherit",cursor:"pointer",...n}),tF={padding:"8px 12px",borderRadius:12,border:"1.5px solid ".concat(d.g200),fontSize:13,fontFamily:"inherit",outline:"none",background:d.w,color:d.g900,transition:"border-color 0.2s"},tR={background:d.w,borderRadius:20,padding:"20px",boxShadow:"0 2px 16px rgba(13,148,136,.08)"},tW={width:70,height:70,borderRadius:"50%",border:"none",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:2,fontFamily:"inherit",fontWeight:700,fontSize:10,cursor:"pointer"};return"help"===e?(0,i.jsx)("div",{style:{maxWidth:700,margin:"0 auto",padding:"20px 16px"},children:(0,i.jsxs)("div",{style:tR,children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,i.jsx)("h2",{style:{fontSize:18,fontWeight:700,color:d.pDD,margin:0},children:"\uD83D\uDCD6 使い方ガイド"}),(0,i.jsx)("button",{onClick:()=>{t("main")},style:tB(d.p,d.pDD),children:"✕ 閉じる"})]}),(0,i.jsxs)("div",{style:{fontSize:14,color:d.g700,lineHeight:2},children:[(0,i.jsx)("h3",{style:{color:d.pD,fontSize:15},children:"1. 部屋を選択"}),(0,i.jsx)("p",{children:"トップ画面で診察室・処置室などを選択します。部屋情報は履歴に保存されます。"}),(0,i.jsx)("h3",{style:{color:d.pD,fontSize:15},children:"2. 患者情報を入力"}),(0,i.jsx)("p",{children:"患者名・患者IDを入力欄に記入します。履歴検索に使えます。"}),(0,i.jsx)("h3",{style:{color:d.pD,fontSize:15},children:"3. テンプレートを選択"}),(0,i.jsx)("p",{children:"ASOP・疾患名・美容・処置・経過・フリーの6種類から選べます。用途に合わせて切り替えてください。"}),(0,i.jsx)("h3",{style:{color:d.pD,fontSize:15},children:"4. 録音開始"}),(0,i.jsx)("p",{children:"\uD83C\uDF99ボタンをタップすると録音が始まります。5秒ごとに自動で書き起こしされます。"}),(0,i.jsx)("h3",{style:{color:d.pD,fontSize:15},children:"5. 要約"}),(0,i.jsx)("p",{children:"✓要約ボタンで録音を停止し、AIがカルテ形式で要約します。結果は自動でクリップボードにコピーされます。"}),(0,i.jsx)("h3",{style:{color:d.pD,fontSize:15},children:"6. 小窓（PiP）"}),(0,i.jsx)("p",{children:"\uD83C\uDF1Fボタンで最前面に固定される小窓を表示。電子カルテを操作しながら録音・要約ができます。"}),(0,i.jsx)("h3",{style:{color:d.pD,fontSize:15},children:"7. 履歴"}),(0,i.jsx)("p",{children:"過去の要約は自動保存されます。\uD83D\uDCC2履歴ボタンから検索・復元・削除が可能です。"}),(0,i.jsx)("h3",{style:{color:d.pD,fontSize:15},children:"8. 設定"}),(0,i.jsx)("p",{children:"⚙️から誤字脱字修正辞書の管理ができます。皮膚科の薬剤名・施術名が事前登録されています。"})]})]})}):"about"===e?(0,i.jsx)("div",{style:{maxWidth:700,margin:"0 auto",padding:"20px 16px"},children:(0,i.jsxs)("div",{style:tR,children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,i.jsx)("h2",{style:{fontSize:18,fontWeight:700,color:d.pDD,margin:0},children:"ℹ️ 機能紹介"}),(0,i.jsx)("button",{onClick:()=>{t("main")},style:tB(d.p,d.pDD),children:"✕ 閉じる"})]}),(0,i.jsxs)("div",{style:{fontSize:14,color:d.g700,lineHeight:2},children:[(0,i.jsx)("h3",{style:{color:d.pD},children:"\uD83C\uDF99 リアルタイム音声書き起こし"}),(0,i.jsx)("p",{children:"OpenAI Whisper APIによる高精度な日本語音声認識。5秒間隔で自動書き起こし。"}),(0,i.jsx)("h3",{style:{color:d.pD},children:"\uD83E\uDD16 AI要約"}),(0,i.jsx)("p",{children:"Gemini 2.5 Flashでカルテ形式に自動要約。複数疾患の自動分離にも対応。"}),(0,i.jsx)("h3",{style:{color:d.pD},children:"\uD83D\uDCCB 6種類のテンプレート"}),(0,i.jsx)("p",{children:"ASOP・疾患名・美容・処置・経過・フリー。複数疾患の自動分離にも対応。"}),(0,i.jsx)("h3",{style:{color:d.pD},children:"\uD83D\uDDE3 話者分離"}),(0,i.jsx)("p",{children:"会話内容から医師と患者の発言を自動判別し、適切な項目に振り分けます。"}),(0,i.jsx)("h3",{style:{color:d.pD},children:"\uD83D\uDCD6 誤字脱字修正辞書"}),(0,i.jsx)("p",{children:"皮膚科の薬剤名・施術名・疾患名を事前登録。書き起こし時に自動修正。"}),(0,i.jsx)("h3",{style:{color:d.pD},children:"\uD83C\uDF1F PiP小窓"}),(0,i.jsx)("p",{children:"最前面固定の小窓で、電子カルテ操作中も録音・要約が可能。"}),(0,i.jsx)("h3",{style:{color:d.pD},children:"\uD83D\uDCBE クラウド履歴"}),(0,i.jsx)("p",{children:"Supabaseによる自動保存。患者名・IDで検索可能。"})]})]})}):"hist"===e?(0,i.jsxs)("div",{style:{maxWidth:900,margin:"0 auto",padding:"20px 16px"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,i.jsx)("h2",{style:{fontSize:18,fontWeight:700,color:d.pDD,margin:0},children:"\uD83D\uDCC2 診療履歴"}),(0,i.jsx)("button",{onClick:()=>t("main"),style:tB(d.p,d.pDD),children:"✕ 閉じる"})]}),(0,i.jsx)("input",{value:A,onChange:e=>E(e.target.value),placeholder:"\uD83D\uDD0D 患者名・ID・内容で検索...",style:{...tF,width:"100%",marginBottom:12,padding:"10px 14px",boxSizing:"border-box"}}),0===tc.length?(0,i.jsx)("p",{style:{color:d.g400,textAlign:"center",padding:40},children:"該当する履歴がありません"}):tc.map(e=>(0,i.jsxs)("div",{style:{...tR,marginBottom:10,padding:16,borderLeft:"3px solid ".concat(d.p)},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8,flexWrap:"wrap",gap:6},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[(0,i.jsx)("span",{style:{fontSize:12,color:d.g500,fontWeight:500},children:tk(e.created_at)}),(e.patient_name||e.patient_id)&&(0,i.jsxs)("span",{style:{fontSize:12,padding:"2px 8px",borderRadius:8,background:"#fef3c7",color:"#92400e",fontWeight:600},children:[e.patient_name||"",e.patient_id?" (".concat(e.patient_id,")"):""]}),(0,i.jsx)("span",{style:{fontSize:11,padding:"2px 8px",borderRadius:8,background:d.pLL,color:d.pD,fontWeight:600},children:tI(e.room)}),(0,i.jsx)("span",{style:{fontSize:11,padding:"2px 8px",borderRadius:8,background:"#f0fdf4",color:d.rG,fontWeight:600},children:tz(e.template)})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,i.jsx)("button",{onClick:()=>{a(e.input_text),x(e.output_text),T(e.patient_name||""),P(e.patient_id||""),t("main")},style:{padding:"4px 10px",borderRadius:8,border:"1px solid ".concat(d.g200),background:d.w,fontSize:11,fontFamily:"inherit",cursor:"pointer"},children:"\uD83D\uDCC2 開く"}),(0,i.jsx)("button",{onClick:()=>tv(e.output_text),style:{padding:"4px 10px",borderRadius:8,border:"1px solid ".concat(d.g200),background:d.w,fontSize:11,fontFamily:"inherit",cursor:"pointer"},children:"\uD83D\uDCCB"}),(0,i.jsx)("button",{onClick:()=>td(e.id),style:{padding:"4px 10px",borderRadius:8,border:"1px solid #fecaca",background:d.w,fontSize:11,fontFamily:"inherit",cursor:"pointer",color:d.err},children:"\uD83D\uDDD1"})]})]}),(0,i.jsx)("div",{style:{fontSize:13,color:d.g700,lineHeight:1.6,whiteSpace:"pre-wrap",maxHeight:80,overflow:"hidden"},children:e.output_text})]},e.id))]}):"doc"===e?(0,i.jsx)("div",{style:{maxWidth:700,margin:"0 auto",padding:"20px 16px"},children:(0,i.jsxs)("div",{style:tR,children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,i.jsx)("h2",{style:{fontSize:18,fontWeight:700,color:d.pDD,margin:0},children:"\uD83D\uDCC4 説明資料の作成"}),(0,i.jsx)("button",{onClick:()=>t("main"),style:tB(d.p,d.pDD),children:"✕ 閉じる"})]}),(0,i.jsx)("p",{style:{fontSize:13,color:d.g500,marginBottom:12},children:"疾患名や施術名を入力すると、当院の診療履歴をAIが参照して患者向け説明資料を自動生成します。"}),(0,i.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12},children:[(0,i.jsx)("input",{value:em,onChange:e=>ey(e.target.value),placeholder:"疾患名・施術名を入力（例：アトピー性皮膚炎、ポテンツァ）",style:{...tF,flex:1,padding:"10px 14px",fontSize:14}}),(0,i.jsx)("button",{onClick:te,disabled:ej||!em.trim(),style:{padding:"10px 20px",borderRadius:14,border:"none",background:ej?d.g200:"linear-gradient(135deg,".concat(d.pD,",").concat(d.p,")"),color:d.w,fontSize:14,fontWeight:700,fontFamily:"inherit",cursor:"pointer",opacity:em.trim()?1:.45},children:ej?"⏳ 生成中...":"✨ 生成"})]}),(0,i.jsx)("div",{style:{display:"flex",gap:6,marginBottom:8,flexWrap:"wrap"},children:["アトピー性皮膚炎","ざ瘡（ニキビ）","蕁麻疹","乾癬","帯状疱疹","尋常性疣贅","脂漏性皮膚炎","円形脱毛症","白斑","酒さ","シミ・肝斑","医療脱毛","ポテンツァ","ノーリス（IPL）","ゼオスキン","ピーリング","外用方法の説明","皮膚腫瘍切除術後の注意点","レーザー施術後の注意点","ピーリング後の注意点"].map(e=>(0,i.jsx)("button",{onClick:()=>{ey(e)},style:{padding:"3px 10px",borderRadius:8,border:"1px solid ".concat(d.p,"44"),background:d.pLL,fontSize:11,fontWeight:500,color:d.pD,fontFamily:"inherit",cursor:"pointer"},children:e},e))}),(0,i.jsx)("textarea",{value:ev,onChange:e=>ew(e.target.value),placeholder:"追加指示（任意）：例「小児向けに平易な表現で」「治療費の目安欄も追加して」「英語併記で」",rows:2,style:{...tF,width:"100%",padding:"8px 12px",fontSize:13,marginBottom:12,resize:"vertical",boxSizing:"border-box"}}),ej&&(0,i.jsxs)("div",{style:{textAlign:"center",padding:20},children:[(0,i.jsx)("div",{style:{width:32,height:32,border:"3px solid ".concat(d.g200),borderTop:"3px solid ".concat(d.p),borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 10px"}}),(0,i.jsx)("span",{style:{color:d.g500},children:"AIが履歴を分析して説明資料を作成中..."})]}),eb&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,i.jsxs)("span",{style:{fontSize:13,fontWeight:700,color:d.pD},children:["\uD83D\uDCCB ",em," 説明資料"]}),(0,i.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(eb)},style:{padding:"4px 12px",borderRadius:10,border:"1px solid ".concat(d.p,"44"),background:d.w,fontSize:12,fontWeight:600,color:d.pD,fontFamily:"inherit",cursor:"pointer"},children:"\uD83D\uDCCB コピー"})]}),(0,i.jsx)("textarea",{value:eb,onChange:e=>eD(e.target.value),style:{width:"100%",height:400,padding:14,borderRadius:12,border:"1px solid ".concat(d.g200),background:d.w,fontSize:14,color:d.g900,fontFamily:"inherit",resize:"vertical",lineHeight:1.8,boxSizing:"border-box"}})]})]})}):"minutes"===e?(0,i.jsx)("div",{style:{maxWidth:700,margin:"0 auto",padding:"20px 16px"},children:(0,i.jsxs)("div",{style:tR,children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,i.jsx)("h2",{style:{fontSize:18,fontWeight:700,color:d.pDD,margin:0},children:"\uD83D\uDCDD 議事録まとめ"}),(0,i.jsx)("button",{onClick:()=>{tl(),t("main")},style:tB(d.p,d.pDD),children:"✕ 閉じる"})]}),(0,i.jsx)("p",{style:{fontSize:13,color:d.g500,marginBottom:12},children:"会議やミーティングを録音・書き起こしし、AIが議事録を自動作成します。"}),(0,i.jsx)("textarea",{value:eL,onChange:e=>eT(e.target.value),placeholder:"AIへの追加指示（任意）：例「院内勉強会の形式で」「スタッフミーティング用に簡潔に」",rows:2,style:{...tF,width:"100%",padding:"8px 12px",fontSize:13,marginBottom:10,resize:"vertical",boxSizing:"border-box"}}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[(0,i.jsxs)("span",{style:{fontSize:24,fontWeight:700,fontVariantNumeric:"tabular-nums",color:d.pD},children:[String(Math.floor(eA/60)).padStart(2,"0"),":",String(eA%60).padStart(2,"0")]}),"inactive"===eC?(0,i.jsx)("button",{onClick:to,style:{padding:"10px 24px",borderRadius:14,border:"none",background:"linear-gradient(135deg,".concat(d.pD,",").concat(d.p,")"),color:d.w,fontSize:14,fontWeight:700,fontFamily:"inherit",cursor:"pointer"},children:"\uD83C\uDF99 録音開始"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{onClick:ta,style:{padding:"10px 20px",borderRadius:14,border:"none",background:"linear-gradient(135deg,".concat(d.pDD,",").concat(d.pD,")"),color:d.w,fontSize:14,fontWeight:700,fontFamily:"inherit",cursor:"pointer"},children:"✓ 要約"}),(0,i.jsx)("button",{onClick:tl,style:{padding:"10px 16px",borderRadius:14,border:"none",background:d.err,color:d.w,fontSize:14,fontWeight:700,fontFamily:"inherit",cursor:"pointer"},children:"⏹ 停止"})]}),(0,i.jsx)("span",{style:{fontSize:12,color:"recording"===eC?d.rG:d.g400,fontWeight:600},children:"recording"===eC?"● 録音中":"停止"})]}),(0,i.jsxs)("div",{style:{marginBottom:12},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[(0,i.jsx)("span",{style:{fontSize:12,fontWeight:600,color:d.g500},children:"書き起こし（10秒間隔）"}),(0,i.jsx)("span",{style:{fontSize:11,color:d.g400},children:ez.length>0?Math.ceil(ez.length/40)+"行":"未入力"})]}),(0,i.jsx)("textarea",{value:ez,onChange:e=>eI(e.target.value),placeholder:"録音開始すると自動で書き起こされます。手動入力も可能です。",style:{width:"100%",height:120,padding:10,borderRadius:12,border:"1px solid ".concat(d.g200),background:d.g50,fontSize:13,color:d.g900,fontFamily:"inherit",resize:"vertical",lineHeight:1.6,boxSizing:"border-box"}})]}),eR&&(0,i.jsxs)("div",{style:{textAlign:"center",padding:20},children:[(0,i.jsx)("div",{style:{width:32,height:32,border:"3px solid ".concat(d.g200),borderTop:"3px solid ".concat(d.p),borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 10px"}}),(0,i.jsx)("span",{style:{color:d.g500},children:"AIが議事録を作成中..."})]}),eB&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,i.jsx)("span",{style:{fontSize:13,fontWeight:700,color:d.pD},children:"\uD83D\uDCCB 議事録"}),(0,i.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(eB)},style:{padding:"4px 12px",borderRadius:10,border:"1px solid ".concat(d.p,"44"),background:d.w,fontSize:12,fontWeight:600,color:d.pD,fontFamily:"inherit",cursor:"pointer"},children:"\uD83D\uDCCB コピー"})]}),(0,i.jsx)("textarea",{value:eB,onChange:e=>eF(e.target.value),style:{width:"100%",height:300,padding:14,borderRadius:12,border:"1px solid ".concat(d.g200),background:d.w,fontSize:14,color:d.g900,fontFamily:"inherit",resize:"vertical",lineHeight:1.8,boxSizing:"border-box"}})]})]})}):"settings"===e?(0,i.jsxs)("div",{style:{maxWidth:900,margin:"0 auto",padding:"20px 16px"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,i.jsx)("h2",{style:{fontSize:18,fontWeight:700,color:d.pDD,margin:0},children:"⚙️ 設定"}),(0,i.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[eN&&(0,i.jsx)("span",{style:{fontSize:12,color:d.rG,fontWeight:600},children:eN}),(0,i.jsx)("button",{onClick:()=>{try{localStorage.setItem("mk_logo",Y),localStorage.setItem("mk_logoSize",String($)),localStorage.setItem("mk_dict",JSON.stringify(G)),localStorage.setItem("mk_snippets",JSON.stringify(ea)),localStorage.setItem("mk_pipSnippets",JSON.stringify(eg)),localStorage.setItem("mk_audioSave",e_?"1":"0"),localStorage.setItem("mk_dictEnabled",X?"1":"0"),eJ("✓ 保存しました"),setTimeout(()=>eJ(""),3e3)}catch(e){eJ("保存エラー")}},style:{padding:"8px 20px",borderRadius:12,border:"none",background:"linear-gradient(135deg,".concat(d.pD,",").concat(d.p,")"),color:d.w,fontSize:14,fontWeight:700,fontFamily:"inherit",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,.1)"},children:"\uD83D\uDCBE 保存"}),(0,i.jsx)("button",{onClick:()=>t("main"),style:tB(d.p,d.pDD),children:"✕ 閉じる"})]})]}),(0,i.jsxs)("div",{style:{...tR,marginBottom:16},children:[(0,i.jsx)("h3",{style:{fontSize:15,fontWeight:700,color:d.pDD,marginBottom:8},children:"\uD83D\uDD0A 音声保存"}),(0,i.jsx)("p",{style:{fontSize:12,color:d.g400,marginBottom:8},children:"ONにすると診察の音声をSupabase Storageに保存します。カウンセリング分析やトークスクリプト改善に活用できます。"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,i.jsx)("button",{onClick:()=>eP(!e_),style:{padding:"6px 20px",borderRadius:10,border:"none",background:e_?d.rG:d.g200,color:e_?d.w:d.g500,fontSize:13,fontWeight:700,fontFamily:"inherit",cursor:"pointer"},children:e_?"ON":"OFF"}),(0,i.jsx)("span",{style:{fontSize:12,color:e_?d.rG:d.g400},children:e_?"録音停止時に自動保存されます":"音声は保存されません"})]})]}),(0,i.jsxs)("div",{style:{...tR,marginBottom:16},children:[(0,i.jsx)("h3",{style:{fontSize:15,fontWeight:700,color:d.pDD,marginBottom:8},children:"\uD83D\uDDBC ロゴ設定"}),(0,i.jsx)("p",{style:{fontSize:12,color:d.g400,marginBottom:8},children:"画像をドロップまたはクリックしてアップロード"}),(0,i.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"flex-start",marginBottom:8},children:[(0,i.jsx)("div",{onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let t=e.dataTransfer.files[0];if(t&&t.type.startsWith("image/")){let e=new FileReader;e.onload=e=>K(e.target.result),e.readAsDataURL(t)}},onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{let t=e.target.files[0];if(t){let e=new FileReader;e.onload=e=>K(e.target.result),e.readAsDataURL(t)}},e.click()},style:{width:80,height:80,borderRadius:12,border:"2px dashed "+d.g200,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",overflow:"hidden",flexShrink:0},children:Y?(0,i.jsx)("img",{src:Y,alt:"logo",style:{width:"100%",height:"100%",objectFit:"contain"}}):(0,i.jsxs)("span",{style:{fontSize:11,color:d.g400,textAlign:"center"},children:["クリック",(0,i.jsx)("br",{}),"or",(0,i.jsx)("br",{}),"ドロップ"]})}),(0,i.jsxs)("div",{children:[Y&&(0,i.jsx)("button",{onClick:()=>K(""),style:{padding:"4px 12px",borderRadius:8,border:"1px solid "+d.g200,background:d.w,fontSize:12,color:d.err,fontFamily:"inherit",cursor:"pointer",marginBottom:6,display:"block"},children:"ロゴ削除"}),(0,i.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[(0,i.jsx)("span",{style:{fontSize:11,color:d.g500},children:"サイズ:"}),[24,32,40,48].map(e=>(0,i.jsxs)("button",{onClick:()=>ee(e),style:{padding:"3px 10px",borderRadius:6,border:$===e?"2px solid ".concat(d.p):"1px solid ".concat(d.g200),background:$===e?d.pLL:d.w,fontSize:11,fontWeight:$===e?700:400,color:$===e?d.pD:d.g500,fontFamily:"inherit",cursor:"pointer"},children:[e,"px"]},e))]})]})]})]}),(0,i.jsxs)("div",{style:{...tR,marginBottom:16},children:[(0,i.jsxs)("h3",{style:{fontSize:15,fontWeight:700,color:d.pDD,marginBottom:8},children:["\uD83D\uDCCC 追記テンプレート（",ea.length,"件）"]}),(0,i.jsx)("p",{style:{fontSize:12,color:d.g400,marginBottom:10},children:"⭐=常時表示＋小窓 / 他はカテゴリ別アコーディオン"}),(0,i.jsxs)("div",{style:{display:"flex",gap:4,marginBottom:6,flexWrap:"wrap"},children:[(0,i.jsx)("input",{value:ed,onChange:e=>ec(e.target.value),placeholder:"タイトル",style:{...tF,width:100}}),(0,i.jsx)("input",{id:"newSnCat",placeholder:"カテゴリ",style:{...tF,width:80}}),(0,i.jsx)("input",{value:ep,onChange:e=>eu(e.target.value),placeholder:"追記テキスト内容",style:{...tF,flex:1}}),(0,i.jsx)("button",{onClick:()=>{if(ed.trim()&&ep.trim()){var e;let t=document.getElementById("newSnCat");es([...ea,{title:ed.trim(),text:ep.trim(),cat:(null==t?void 0:null===(e=t.value)||void 0===e?void 0:e.trim())||"その他"}]),ec(""),eu(""),t&&(t.value="")}},style:tB(d.p,"#fff",{padding:"6px 14px",fontSize:13}),children:"追加"})]}),(0,i.jsx)("div",{style:{maxHeight:400,overflow:"auto"},children:ea.map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",gap:3,alignItems:"flex-start",padding:"4px 0",borderBottom:"1px solid "+d.g100},children:[(0,i.jsx)("button",{onClick:()=>{eg.includes(t)?ex(eg.filter(e=>e!==t)):ex([...eg,t])},style:{padding:"3px 5px",borderRadius:6,border:eg.includes(t)?"2px solid ".concat(d.p):"1px solid ".concat(d.g200),background:eg.includes(t)?d.pLL:d.w,fontSize:9,color:eg.includes(t)?d.pD:d.g400,fontFamily:"inherit",cursor:"pointer",flexShrink:0},title:"常時表示+小窓",children:eg.includes(t)?"⭐":"☆"}),(0,i.jsx)("input",{value:e.cat||"",onChange:e=>{let n=[...ea];n[t]={...n[t],cat:e.target.value},es(n)},style:{...tF,width:60,padding:"3px 5px",fontSize:10,color:d.g500},title:"カテゴリ"}),(0,i.jsx)("input",{value:e.title,onChange:e=>{let n=[...ea];n[t]={...n[t],title:e.target.value},es(n)},style:{...tF,width:80,padding:"3px 5px",fontSize:11,fontWeight:700,color:d.pD}}),(0,i.jsx)("textarea",{value:e.text,onChange:e=>{let n=[...ea];n[t]={...n[t],text:e.target.value},es(n)},rows:1,onFocus:e=>{e.target.rows=Math.max(2,e.target.value.split("\n").length)},onBlur:e=>{e.target.rows=1},style:{...tF,flex:1,padding:"3px 5px",fontSize:10,color:d.g700,resize:"vertical",lineHeight:1.5}}),(0,i.jsx)("button",{onClick:()=>{es(ea.filter((e,n)=>n!==t)),ex(eg.filter(e=>e!==t).map(e=>e>t?e-1:e))},style:{padding:"3px 6px",borderRadius:6,border:"1px solid #fecaca",background:d.w,fontSize:9,color:d.err,fontFamily:"inherit",cursor:"pointer",flexShrink:0},children:"✕"})]},t))})]}),(0,i.jsxs)("div",{style:{...tR,marginBottom:16},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,i.jsxs)("h3",{style:{fontSize:15,fontWeight:700,color:d.pDD,margin:0},children:["\uD83D\uDCD6 誤字脱字修正辞書（",G.length,"件）"]}),(0,i.jsx)("button",{onClick:()=>Q(!X),style:{padding:"4px 14px",borderRadius:10,border:"none",background:X?d.rG:d.g200,color:X?d.w:d.g500,fontSize:12,fontWeight:700,fontFamily:"inherit",cursor:"pointer"},children:X?"ON":"OFF"})]}),(0,i.jsx)("p",{style:{fontSize:12,color:d.g400,marginBottom:12},children:"書き起こし結果に自動適用。左の文字列を右に置換します。"}),(0,i.jsxs)("div",{style:{display:"flex",gap:6,marginBottom:12},children:[(0,i.jsx)("input",{value:U,onChange:e=>V(e.target.value),placeholder:"変換前",style:{...tF,flex:1}}),(0,i.jsx)("span",{style:{alignSelf:"center",color:d.g400},children:"→"}),(0,i.jsx)("input",{value:q,onChange:e=>Z(e.target.value),placeholder:"変換後",style:{...tF,flex:1}}),(0,i.jsx)("button",{onClick:()=>{U.trim()&&q.trim()&&(H([[U.trim(),q.trim()],...G]),V(""),Z(""))},style:tB(d.p,d.pDD,{padding:"6px 14px",fontSize:13}),children:"追加"})]}),(0,i.jsx)("div",{style:{maxHeight:400,overflow:"auto"},children:G.map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center",padding:"4px 0",borderBottom:"1px solid ".concat(d.g100)},children:[(0,i.jsx)("span",{style:{flex:1,fontSize:12,color:d.g500},children:e[0]}),(0,i.jsx)("span",{style:{color:d.g400,fontSize:11},children:"→"}),(0,i.jsx)("span",{style:{flex:1,fontSize:12,color:d.g900,fontWeight:600},children:e[1]}),(0,i.jsx)("button",{onClick:()=>H(G.filter((e,n)=>n!==t)),style:{padding:"2px 8px",borderRadius:6,border:"1px solid #fecaca",background:d.w,fontSize:10,color:d.err,fontFamily:"inherit",cursor:"pointer"},children:"✕"})]},t))})]})]}):(0,i.jsxs)("div",{style:{maxWidth:900,margin:"0 auto",padding:"20px 16px"},children:[(0,i.jsxs)("header",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12,padding:"10px 16px",background:"linear-gradient(135deg,".concat(d.pD,",").concat(d.p,")"),borderRadius:16,boxShadow:"0 4px 16px rgba(13,148,136,.15)"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[Y?(0,i.jsx)("img",{src:Y,alt:"logo",style:{width:$,height:$,borderRadius:6,objectFit:"contain"}}):(0,i.jsx)("span",{style:{fontSize:18},children:"\uD83E\uDE7A"}),(0,i.jsx)("span",{style:{fontWeight:700,fontSize:14,color:d.w},children:"南草津皮フ科AIカルテ要約"})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:5},children:[C>0&&(0,i.jsx)("span",{style:{fontSize:12,color:d.warn,fontWeight:600},children:"⏳"}),(0,i.jsx)("span",{style:{fontSize:11,color:h.includes("✓")?"#86efac":"rgba(255,255,255,.7)",fontWeight:h.includes("✓")?600:400},children:h})]})]}),(0,i.jsx)("div",{style:{display:"flex",gap:4,marginBottom:8,flexWrap:"wrap"},children:[{p:"hist",i:"\uD83D\uDCC2",t:"履歴",f:()=>{ts(),t("hist")}},{p:"settings",i:"⚙️",t:"設定"},{p:"doc",i:"\uD83D\uDCC4",t:"資料作成"},{p:"minutes",i:"\uD83D\uDCDD",t:"議事録"},{p:"help",i:"❓",t:"ヘルプ"}].map(e=>(0,i.jsxs)("button",{onClick:e.f||(()=>t(e.p)),style:{padding:"5px 10px",borderRadius:10,border:"1.5px solid ".concat(d.g200),background:d.w,fontSize:11,fontWeight:600,fontFamily:"inherit",cursor:"pointer",color:d.pD,display:"flex",alignItems:"center",gap:3},children:[(0,i.jsx)("span",{style:{fontSize:14},children:e.i}),e.t]},e.p))}),(0,i.jsx)("div",{style:{display:"flex",gap:4,marginBottom:8,flexWrap:"wrap"},children:p.map(e=>(0,i.jsx)("button",{onClick:()=>F(e.id),style:{padding:"5px 10px",borderRadius:10,fontSize:12,fontFamily:"inherit",cursor:"pointer",border:B===e.id?"2px solid ".concat(d.pD):"1.5px solid ".concat(d.g200),background:B===e.id?d.pL:d.w,fontWeight:B===e.id?700:500,color:B===e.id?d.pDD:d.g500},children:e.l},e.id))}),(0,i.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:8,alignItems:"center"},children:[(0,i.jsx)("span",{style:{fontSize:12,color:d.g500,flexShrink:0},children:"\uD83C\uDFA4"}),(0,i.jsx)("select",{value:ei,onChange:e=>er(e.target.value),style:{flex:1,padding:"6px 10px",borderRadius:10,border:"1.5px solid ".concat(d.g200),fontSize:12,fontFamily:"inherit",color:d.g700,background:d.w,cursor:"pointer"},children:0===et.length?(0,i.jsx)("option",{value:"",children:"マイクが見つかりません"}):et.map((e,t)=>(0,i.jsx)("option",{value:e.deviceId,children:e.label||"マイク ".concat(t+1)},e.deviceId))}),(0,i.jsx)("button",{onClick:eo,style:{padding:"5px 10px",borderRadius:8,border:"1px solid ".concat(d.g200),background:d.w,fontSize:11,fontFamily:"inherit",cursor:"pointer",color:d.g500,flexShrink:0},children:"\uD83D\uDD04"})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:10},children:[(0,i.jsx)("input",{value:L,onChange:e=>T(e.target.value),placeholder:"\uD83D\uDC64 患者名",style:{...tF,flex:1}}),(0,i.jsx)("input",{value:_,onChange:e=>P(e.target.value),placeholder:"\uD83D\uDD22 患者ID",style:{...tF,width:120}})]}),(0,i.jsx)("div",{style:{display:"flex",gap:5,flexWrap:"wrap",marginBottom:10},children:c.map(e=>(0,i.jsx)("button",{onClick:()=>I(e.id),style:{padding:"5px 12px",borderRadius:20,fontSize:12,fontFamily:"inherit",cursor:"pointer",border:z===e.id?"2px solid ".concat(d.p):"2px solid transparent",background:z===e.id?d.pLL:d.g100,fontWeight:z===e.id?700:500,color:z===e.id?d.pD:d.g500,transition:"all 0.15s"},children:e.name},e.id))}),(0,i.jsxs)("div",{style:{...tR,position:"relative"},children:[(0,i.jsxs)("button",{onClick:N?tC:tw,style:{position:"absolute",top:16,right:16,width:50,height:50,borderRadius:"50%",border:"none",background:N?d.rG:"linear-gradient(135deg,".concat(d.pD,",").concat(d.p,")"),color:d.w,fontSize:11,fontWeight:700,fontFamily:"inherit",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:1,boxShadow:N?"0 0 0 3px rgba(34,197,94,.3)":"0 2px 8px rgba(13,148,136,.25)"},children:[(0,i.jsx)("span",{style:{fontSize:18},children:"\uD83C\uDF1F"}),(0,i.jsx)("span",{style:{fontSize:9},children:N?"OFF":"小窓"})]}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,marginBottom:16},children:["inactive"!==n&&(0,i.jsx)("span",{style:{fontSize:28,fontWeight:700,color:"recording"===n?d.rG:d.warn,fontVariantNumeric:"tabular-nums"},children:"".concat(String(Math.floor(m/60)).padStart(2,"0"),":").concat(String(m%60).padStart(2,"0"))}),"recording"===n&&(0,i.jsx)("div",{style:{width:"60%",height:6,borderRadius:3,background:d.g200,overflow:"hidden"},children:(0,i.jsx)("div",{style:{width:"".concat(j,"%"),height:"100%",background:"linear-gradient(90deg,".concat(d.rG,",").concat(d.p,")"),borderRadius:3,transition:"width 0.1s"}})}),(0,i.jsx)("div",{style:{display:"flex",gap:12,alignItems:"center"},children:"inactive"===n?(0,i.jsxs)("button",{onClick:tf,style:{...tW,width:90,height:90,background:"linear-gradient(135deg,".concat(d.pD,",").concat(d.p,")"),color:d.w,boxShadow:"0 4px 14px rgba(13,148,136,.25)"},children:[(0,i.jsx)("span",{style:{fontSize:30},children:"\uD83C\uDF99"}),(0,i.jsx)("span",{style:{fontSize:12},children:"録音開始"})]}):(0,i.jsxs)(i.Fragment,{children:["recording"===n?(0,i.jsx)("button",{onClick:ty,style:{...tW,width:60,height:60,background:d.warn,color:"#78350f"},children:(0,i.jsx)("span",{style:{fontSize:22},children:"⏸"})}):(0,i.jsx)("button",{onClick:tb,style:{...tW,width:60,height:60,background:d.rG,color:d.w},children:(0,i.jsx)("span",{style:{fontSize:22},children:"▶"})}),(0,i.jsxs)("button",{onClick:tj,style:{...tW,width:80,height:80,background:"linear-gradient(135deg,".concat(d.pDD,",").concat(d.pD,")"),color:d.w,boxShadow:"0 4px 14px rgba(13,148,136,.25)"},children:[(0,i.jsx)("span",{style:{fontSize:20},children:"✓"}),(0,i.jsx)("span",{style:{fontSize:12},children:"要約"})]}),(0,i.jsx)("button",{onClick:tm,style:{...tW,width:60,height:60,background:d.err,color:d.w},children:(0,i.jsx)("span",{style:{fontSize:22},children:"⏹"})})]})}),"recording"===n&&(0,i.jsx)("div",{style:{fontSize:12,color:d.g400},children:"\uD83C\uDF99 5秒ごとに自動書き起こし"})]}),(0,i.jsxs)("div",{style:{marginBottom:14},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[(0,i.jsx)("label",{style:{fontSize:13,fontWeight:700,color:d.g500},children:"\uD83D\uDCDD 書き起こし"}),(0,i.jsxs)("span",{style:{fontSize:12,color:d.g400},children:[l.length,"文字"]})]}),(0,i.jsx)("textarea",{value:l,onChange:e=>a(e.target.value),placeholder:"録音ボタンで音声を書き起こし、または直接入力...",style:{width:"100%",height:140,padding:12,borderRadius:14,border:"1.5px solid ".concat(d.g200),background:d.g50,fontSize:14,color:d.g900,fontFamily:"inherit",resize:"vertical",lineHeight:1.7,boxSizing:"border-box"}})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:14},children:[(0,i.jsx)("button",{onClick:()=>tD(),disabled:b||!l.trim(),style:{flex:1,padding:"10px 0",borderRadius:14,border:"none",background:b?d.g200:"linear-gradient(135deg,".concat(d.pD,",").concat(d.p,")"),color:d.w,fontSize:14,fontWeight:700,fontFamily:"inherit",cursor:"pointer",opacity:l.trim()?1:.45,boxShadow:!b&&l.trim()?"0 4px 12px rgba(13,148,136,.25)":"none"},children:b?"⏳ 処理中...":"⚡ 要約"}),(0,i.jsx)("button",{onClick:()=>{a(""),x(""),f("クリアしました")},style:{padding:"10px 16px",borderRadius:14,border:"1px solid ".concat(d.g200),background:d.w,fontSize:14,fontWeight:600,color:d.g500,fontFamily:"inherit",cursor:"pointer"},children:"\uD83D\uDDD1"}),(0,i.jsx)("button",{onClick:tS,style:{padding:"10px 20px",borderRadius:14,border:"2px solid ".concat(d.p),background:d.w,fontSize:14,fontWeight:700,color:d.pD,fontFamily:"inherit",cursor:"pointer"},children:"次へ ▶"})]}),g&&(0,i.jsxs)("div",{style:{borderRadius:14,border:"2px solid ".concat(d.pL),padding:16,background:"linear-gradient(135deg,".concat(d.pLL,",#f0fdf4)")},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,i.jsxs)("span",{style:{fontSize:13,fontWeight:700,color:d.pD},children:[e7.name," 要約結果"]}),(0,i.jsx)("button",{onClick:()=>tv(g),style:{padding:"4px 12px",borderRadius:10,border:"1px solid ".concat(d.p,"44"),background:d.w,fontSize:12,fontWeight:600,color:d.pD,fontFamily:"inherit",cursor:"pointer"},children:"\uD83D\uDCCB コピー"})]}),(0,i.jsx)("textarea",{value:g,onChange:e=>x(e.target.value),style:{width:"100%",height:180,padding:12,borderRadius:12,border:"1px solid ".concat(d.g200),background:d.w,fontSize:14,color:d.g900,fontFamily:"inherit",resize:"vertical",lineHeight:1.7,boxSizing:"border-box"}}),ea.length>0&&(0,i.jsxs)("div",{style:{marginTop:8},children:[(0,i.jsx)("div",{style:{display:"flex",gap:4,flexWrap:"wrap",marginBottom:4},children:ea.map((e,t)=>eg.includes(t)?(0,i.jsxs)("button",{onClick:()=>x(t=>t+(t?"\n":"")+e.text),style:{padding:"4px 10px",borderRadius:10,border:"1.5px solid ".concat(d.p),background:d.pLL,fontSize:12,fontWeight:600,color:d.pD,fontFamily:"inherit",cursor:"pointer"},children:["⭐",e.title]},t):null)}),[...new Set(ea.map(e=>e.cat||"その他"))].map(e=>{let t=ea.map((e,t)=>({...e,idx:t})).filter(t=>(t.cat||"その他")===e&&!eg.includes(t.idx));if(!t.length)return null;let n=eh.includes(e);return(0,i.jsxs)("div",{style:{marginBottom:2},children:[(0,i.jsxs)("button",{onClick:()=>ef(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e]),style:{width:"100%",padding:"3px 8px",borderRadius:6,border:"1px solid ".concat(d.g200),background:n?d.pLL:d.g50,fontSize:11,fontWeight:600,color:d.pD,fontFamily:"inherit",cursor:"pointer",textAlign:"left",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)("span",{children:[e,"（",t.length,"）"]}),(0,i.jsx)("span",{children:n?"▼":"▶"})]}),n&&(0,i.jsx)("div",{style:{display:"flex",gap:4,flexWrap:"wrap",padding:"4px 0"},children:t.map(e=>(0,i.jsx)("button",{onClick:()=>x(t=>t+(t?"\n":"")+e.text),style:{padding:"3px 8px",borderRadius:8,border:"1px solid ".concat(d.p,"33"),background:d.w,fontSize:11,fontWeight:500,color:d.pD,fontFamily:"inherit",cursor:"pointer"},children:e.title},e.idx))})]},e)})]})]}),b&&(0,i.jsxs)("div",{style:{textAlign:"center",padding:20},children:[(0,i.jsx)("div",{style:{width:32,height:32,border:"3px solid ".concat(d.g200),borderTop:"3px solid ".concat(d.p),borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 10px"}}),(0,i.jsx)("span",{style:{color:d.g500},children:"AIが要約を作成中..."})]})]})]})}}},function(e){e.O(0,[53,971,117,744],function(){return e(e.s=9831)}),_N_E=e.O()}]);