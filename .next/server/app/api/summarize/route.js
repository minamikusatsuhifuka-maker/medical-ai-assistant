"use strict";(()=>{var e={};e.id=764,e.ids=[764],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2884:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>x,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var a={};r.r(a),r.d(a,{POST:()=>m});var n=r(9303),s=r(8716),o=r(670),i=r(7070);let p=`あなたは皮膚科専門の優秀な医療秘書です。以下の音声書き起こしテキストを簡潔に要約してください。`;async function u(e,t){let r=process.env.GEMINI_API_KEY;if(!r)throw Error("GEMINI_API_KEY が設定されていません");let a=null;for(let n of["gemini-2.5-flash","gemini-2.5-pro","gemini-2.0-flash"])try{let s=`https://generativelanguage.googleapis.com/v1beta/models/${n}:generateContent?key=${r}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({system_instruction:{parts:[{text:t}]},contents:[{parts:[{text:e}]}],generationConfig:{temperature:.3,maxOutputTokens:4096}})});if(!o.ok){a=`${n}: HTTP ${o.status}`;continue}let i=await o.json();if(i.candidates?.[0]?.content?.parts)return i.candidates[0].content.parts.map(e=>e.text||"").join("");a=`${n}: ${JSON.stringify(i?.error||i)}`}catch(e){a=`${n}: ${e.message}`}throw Error("Gemini全モデル失敗: "+a)}async function c(e,t){let r=process.env.CLAUDE_API_KEY;if(!r)throw Error("CLAUDE_API_KEY が設定されていません");let a=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":r,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:"claude-sonnet-4-5-20250929",max_tokens:4096,system:t,messages:[{role:"user",content:e}]})}),n=await a.json();if(n.content?.[0]?.text)return n.content[0].text;throw Error("Claude応答エラー: "+JSON.stringify(n))}async function m(e){try{let t;let{text:r,mode:a,prompt:n}=await e.json();if(!r||""===r.trim())return i.NextResponse.json({error:"テキストが必要です"},{status:400});let s=n||p;return t="claude"===a?await c(r,s):await u(r,s),i.NextResponse.json({summary:t})}catch(e){return console.error("Summarize error:",e),i.NextResponse.json({error:"要約エラー: "+e.message},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/summarize/route",pathname:"/api/summarize",filename:"route",bundlePath:"app/api/summarize/route"},resolvedPagePath:"/Users/tpjatpja/Desktop/medical-ai-assistant/app/api/summarize/route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:g,serverHooks:h}=l,f="/api/summarize/route";function x(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,972],()=>r(2884));module.exports=a})();